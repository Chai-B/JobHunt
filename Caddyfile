{$API_DOMAIN} {
    @cors_preflight method OPTIONS
    handle @cors_preflight {
        header Access-Control-Allow-Origin "{http.request.header.origin}"
        header Access-Control-Allow-Methods "GET, POST, PUT, PATCH, DELETE, OPTIONS"
        header Access-Control-Allow-Headers "*"
        header Access-Control-Allow-Credentials "true"
        header Access-Control-Max-Age "3600"
        respond "" 204
    }

    reverse_proxy backend:8000 {
        header_down Access-Control-Allow-Origin "{http.request.header.origin}"
        header_down Access-Control-Allow-Credentials "true"
    }
}
